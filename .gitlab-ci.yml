stages:
  - lint
  - test

.test:
  image: python:3-alpine
  before_script:
    - echo "before testing"
    - apk add build-base
    - apid add openssl-dev
    - apk add libffi-dev
    - pip install --user poetry
    - poetry config virtualenvs.create false
    - poetry install
    - python3 setup.py develop

unit-test:
  stage: test
  extends: .test
  script:
    - echo "testing"
    - python -m unittest discover tests

lint:
  image: python:3-alpine
  stage: lint
  extends: .test
  script:
    - poetry run flake8 .
